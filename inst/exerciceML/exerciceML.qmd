---
title: "Exercice Machine leanrning"
format: html
editor: visual
---

## Partie 1 : Classification supervisée

*Etape 1 : Dans l'onglet "données" : cliquer pour explorer la base de données sur les vins.*

### Combien d'individus dans la base de donnéees brute vins ?

La base de données brute "vins" est constituées de 4898 individus : ces individus sont des références de vins qui ont été goûtés et notés par des professionels. Ils sont caractérisés par une note et leur composition chimique.

### Quelle est la variable à prédire ? De quel type est-elle ?

La variable à prédire est dichotomique (ou booléenne) : il s'agit de la variable "target", qui prend la valeur bon si le vin est bon et mauvais si le vin est mauvais.

### Les modalités de la variable à prédire ont-elles le même poids ?

Non : parmi les 4898 références goûtés par des professionnels, 3 258 sont bons (66,5%) et 1 640 sont mauvais (33,5 %).

### Combien y a t il de variables prédictives ? De quel type sont-elles ?

Il y a 11 variables quantitatives qui sont les compositions chimique du vin.

### Y a-t-il des données manquantes ?

Aucune donnée manquante dans ce jeu de données : c'est très rare d'avoir une base de donnée brute aussi propre !

*Etape 2 : Dans l'onglet "préparation" : conserver 70 % de la base brute pour l'entraînement.*

### A quoi vont servir les bases d'entraînement et de validation ?

### Quelle différence entre la base de validation et la base de test ?

### Quel est le poids de chacune des modalités de la variable à prédire ? Comparer avec la répartition dans la base brute.

### Les variables prédictives ont-elles les mêmes ordre de grandeur ?

*Etape 3 : Dans l'onglet "préparation", appliquer la recette suivante sur la base d'entraînement : "centrer-réduire les quantitatives" (en anglais : step_normalize).*

### Quelle loi suivent les variables quantitatives de la base d'entraînement transformée ?

*Etape 4 : Dans l'onglet "modèle", choisir la régression logistique et ajuster le modèle sur la base d'entraînement.*

### Pourquoi parle-t-on ici d'estimation et pas de prédiction ?

### A partir de quel seuil de probabilité défini par défaut, un vin est estimé comme bon ou mauvais ?

### Quel indicateur nous donne des informations sur la qualité du modèle ?

*Etape 5 : Dans l'onglet "Validation", évaluer la performance du modèle retenu précédemment (modèle 1 : regression logistique sur la base centrée réduite).*

### Combien d'individus sont classés dans la table de confusion ? A quelle base ces individus appartiennent-ils ?

### Pourquoi parle-t-on ici de prédictions et pas d'estimations ?

### A partir de la table de confusion, retrouver les valeurs des trois indicateurs suivants : exactitude, sensibilité, spécificité. Noter ces valeurs pour le premier modèle.

Exactitude : 77 %

Sensibilité : 90 %

Spécificité : 52 %

*Etape 6 : Revenir sur l'onglet "modèle" : choisir l'arbre et ajuster votre modèle sur les données d'entraînement (modèle 2 sur la base centrée réduite).*

### Combien de variables prédictives sont utilisées par l'arbre de regression pour faire des estimations sur la base d'entraînement ?

3 variables seulement sur les 11 variables disponibles : alcohol, free.sulfur.dioxide et volatile.acidity. Il s'agit des 3 variables les plus discriminantes selon l'algorithme CART.

### Quelle variable a été choisie en premier pour séparer la population en deux ? Quel est la valeur seuil ?

*Etape 7 : Dans l'onglet "Validation", évaluer les performances du modèle 2 sur la base centrée réduite.*

### Pour ce deuxième modèle, quelles sont les valeurs des 3 indicateurs suivants : exactitude, sensibilité et spécificité ?

Exactitude : 76 %

Sensibilité : 80 %

Spécificité : 67 %

### Si vous privilégiez l'exactitude, quel modèle faut-il choisir ? Si vous privilégiez la spécificité, quel modèle faut-il choisir ?

*Etape 8 : Ajuster la forêt aléatoire sur la base d'entraînement (dans l'onglet validation) et evaluer la performance du modèle.*

### Combien d'arbres ont été construits par défaut par l'algorithme ? 

Par défaut, l'algorithme construit 500 arbres de classification.

### De combien de variables sont constitués chaque arbre de classification ? Est-ce que ce sont à chaque fois les mêmes variables ?

Chaque arbre est constitué par défaut de 3 variables tirées aléatoirement. Il y a donc une partie aléatoire qui va faire varier les indicateurs.

### Noter les indicateurs dans le tableau comparatif des modèles

| Modèles                              | Exactitude | Sensibilité | Spécificité |
|------------------------------|--------------|--------------|--------------|
| *Modèle 1 : Regression logistique*   | 77 %       | 90 %        | 52 %        |
| *Modèle 2 : arbre de classification* | 76 %       | 80 %        | 67 %        |
| *Modèle 3 : forêt aléatoire*         | 83 %       | 90 %        | 70 %        |
| *Modèle 4 : KNN*                     |            |             |             |

: Performances des modèles

Etape 9 : *Ajuster le KNN (modèle des plus proches voisins) sur la base d'entraînement (dans l'onglet validation) et evaluer la performance du modèle.*

### Quelle valeur par défaut de K a été retenue dans le modèle des plus proches voisins ?

### Noter les indicateurs dans le tableau comparatif des modèles

| Modèle retenu                        | Exactitude | Sensibilité | Spécificité | AUC  |
|------------------------------|-----------|-----------|-----------|---------|
| *Modèle 1 : Regression logistique*   | 77 %       | 90 %        | 52 %        | 0,83 |
| *Modèle 2 : arbre de classification* | 76 %       | 80 %        | 67 %        | 0,77 |
| *Modèle 3 : forêt aléatoire*         | 83 %       | 90 %        | 70 %        | 0,89 |
| *Modèle 4 : KNN*                     | 78 %       | 86 %        | 63 %        | 0,82 |

### Quel modèle est le plus performant selon les différents indicateurs de performance retenus ?

*Etape 10 : Sélectionner le modèle le plus performant que vous avez retenu précemment (dans l'onglet "modèle"), et dans l'onglet "généralisation", ajuster le modèle.*

### La base de test a-t-elle été utilisée pour construire le modèle final ? 

Non ! Le modèle final s'ajuste sur la base d'entraînement (70 % des données) et sur la base de validation (15 % des données).

| Modèle retenu                        | Exactitude | Sensibilité | Spécificité | AUC  |
|-------------------------|------------|------------|------------|------------|
| *Modèle 1 : Regression logistique*   | 99 %       | 100 %       | 98 %        | 1    |
| *Modèle 2 : arbre de classification* | 99 %       | 100 %       | 94 %        | 0,98 |
| *Modèle 3 : forêt aléatoire*         | 99 %       | 100 %       | 96 %        | 1    |
| *Modèle 4 : KNN*                     | 99 %       | 99 %        | 98 %        | 1    |

: Comparaison des performances des modèles sur la base de données Grandile.

## Partie 2 : Regression supervisée
